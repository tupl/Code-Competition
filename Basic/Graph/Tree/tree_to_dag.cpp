// This algorithm works by converting a tree into a dag